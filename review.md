# Reference Behavior Review — Service Desk Onboarding Analyzer (Monolith → Modular)

Document purpose: Define reference behaviors and contracts from the existing Streamlit monolith [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/servicenow_analyzer.py), aligned to the modular target architecture described in [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), to preserve critical semantics and safely evolve improvements without re-reading the monolith.

1. Executive Summary

* Current capabilities (monolith)
  * UI/Entry: Streamlit app with tabs for upload, analysis, visualizations, history placeholder, and reports [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), also summarized in [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Dataset management: In-memory datasets and metadata with file hashing, comparison stats; no dataset persistence [DatasetManager. **init** ()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [DatasetManager.add_dataset()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Filtering: Department filter for DataFrames [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Charts: Quality, complexity, department volume, reassignment distribution, product distribution [ChartGenerator.create_quality_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_complexity_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_department_volume()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_reassignment_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_product_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * AI analysis: Builds ticket-context text with random sampling; composes prompts; calls Azure OpenAI; supports batch questions [OnboardingAnalyzer. **init** ()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [OnboardingAnalyzer.analyze_onboarding_opportunities()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [OnboardingAnalyzer.batch_analyze()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Persistence: SQLite database for analyses; datasets table exists but unused by app [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [get_analysis_history()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Reports: Markdown report generator aggregating analyses and chart count [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Must-preserve semantics (core)
  * Correct filtering by selected departments [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Chart data fidelity for existing distributions, including fallbacks when columns are missing [ChartGenerator.*](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Analysis persistence for question/answer with associated metrics, timestamp, and dataset identifiers [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Report generation consistent with current structure [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * UI-driven configuration inputs for Azure (endpoint, key, deployment), and analysis mode selection [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Planned improvements (aligned to target)
  * Modular architecture with clear layers: UI, API, Engine, Vector/DB, AI, Services, Config/Prompts [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Replace random sampling with stratified sampling across Department × Topic × Quality with per-bucket caps [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Persist datasets and tickets; add embeddings, clustering, retrieval, rerank pipelines [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Observability, governance, prompt versioning and linkage, RBAC, PII handling [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * APIs for running analyses, metrics, reports, and history [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).

2. Preserved vs Improved Semantics Matrix

* Preserve (as-is behaviors to maintain)
  * Department filter logic: returns input df if no departments provided or Department column missing [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Chart semantics: count/frequency distributions with graceful None return when required feature columns are absent [ChartGenerator.create_quality_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_complexity_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_department_volume()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_reassignment_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [ChartGenerator.create_product_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Analysis persistence schema fields: timestamp, dataset_name, dataset_hash, department_filter, question, analysis_result, ticket_count, metrics JSON [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView); preserve data fidelity and atomicity.
  * Report structure: dataset summary, list of Q→analysis sections, total charts included count [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * UI concepts: upload multiple datasets, comparison stats view, Azure config inputs [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Improve (targeted enhancements tied to plan)
  * Sampling strategy: from random sampling [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView) to stratified with per-segment summaries [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Persistence: implement full dataset/ticket persistence; use repositories; link analyses to dataset_id and prompt_version [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Vector intelligence: embeddings, vector search, reranking, clustering pipelines [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Prompt governance: versioned templates, prompt_version linkage, configurable blocks [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Observability and governance: structured logging, metrics, tracing, RBAC, PII [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Performance and scale: caching analytics, avoiding N+1 via repositories, batch operations, durable vector index [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).

3. Behavior Inventory (function/class-level)

A. [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Filter a DataFrame by department names.
* Inputs: df: pandas DataFrame; departments: list.
* Outputs: Filtered DataFrame (subset of rows).
* Side-effects: None.
* Error handling: If departments empty or Department column not present, returns df unmodified.
* Performance: Uses pandas boolean indexing; O(n).
* Limitations: Only filters on Department; no multi-column logic.
* External interactions: None.
* Invariants:
  * If departments is falsy OR Department column missing → output equals input.
  * If present, all output rows have Department ∈ departments.
* Edge cases:
  * Mixed casing or differing department spellings not normalized (To Confirm text normalization policy in target Engine).

B. [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Initialize SQLite DB with analyses and datasets tables.
* Inputs: None.
* Outputs: Creates onboarding_analyses.db file and tables if absent.
* Side-effects: DB schema creation at import time via module-level call [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Error handling: No explicit error capture for DB failures; relies on sqlite3 exceptions.
* Performance: Negligible table existence checks.
* Limitations: No migrations/versioning; no indices beyond autoincrement; datasets table not used elsewhere in monolith.
* Security: File-based SQLite; no encryption-at-rest; To Confirm file path configuration for production use.
* Invariants:
  * analyses table columns per DDL match [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * datasets table columns per DDL match [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Edge cases:
  * Repeated imports re-run CREATE IF NOT EXISTS (idempotent).
  * Concurrent app instances could contend on file locks (To Confirm deployment model).

C. [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Persist a single analysis record.
* Inputs: dataset_name, dataset_hash, department_filter (Optional[str]), question, analysis_result, ticket_count, metrics (dict).
* Outputs: None (writes a row to analyses).
* Side-effects: Writes to SQLite; metrics serialized via json.dumps.
* Error handling: No explicit try/except; assumes happy path.
* Performance: Single INSERT; acceptable for interactive use.
* Limitations: department_filter stored as text; no dataset_id FK; metrics untyped JSON; no prompt_version field in monolith (target adds) [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Security: Parameterized INSERT protects values; DB file-level security remains a concern.
* Invariants:
  * timestamp uses datetime.now().isoformat().
  * analysis_result stored as provided; no size checks (risk for oversized responses).
* Edge cases:
  * Large metrics may exceed practical row size; To Confirm DB size constraints and pruning policy.

D. [get_analysis_history()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Retrieve recent analyses.
* Inputs: limit: int (default 50).
* Outputs: pandas DataFrame of rows ordered by timestamp DESC.
* Side-effects: Opens DB connection; reads SQL.
* Error handling: None explicit; relies on sqlite3.
* Performance: Simple SELECT with LIMIT; OK for small tables.
* Limitations: Uses f-string to build LIMIT; if non-integer passed, potential SQL injection risk (mitigated by expected int usage in code). To Confirm validation in API/UI layer.
* Invariants:
  * Columns as created in analyses table; metrics is JSON string in result.
* Edge cases:
  * Empty result returns empty DataFrame.

E. [DatasetManager. **init** ()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [DatasetManager.add_dataset()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: In-memory dataset storage and metadata capture.
* Inputs:
  * add_dataset(name, df, file_hash)
* Outputs:
  * Updates internal dicts: datasets[name] = df; metadata[name] = {hash, rows, departments, upload_time}.
* Side-effects: Memory growth proportional to dataset size.
* Error handling: None explicit in add_dataset (errors are handled by caller in UI upload flow [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)).
* Performance: Reads entire Excel into memory; metadata computations use nunique and len.
* Limitations:
  * No persistence to SQLite datasets table; names may collide; no duplicate detection beyond file hash presence in metadata (not enforced globally).
* External interactions: None.
* Invariants:
  * metadata[name]['rows'] == len(datasets[name]).
  * If Department column present, metadata[name]['departments'] equals nunique of Department; else 0.
* Edge cases:
  * Loading multiple large datasets can exceed memory.
  * Missing Department column sets departments to 0.

F. [ChartGenerator.create_quality_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Pie chart for ticket_quality distribution.
* Inputs: df DataFrame.
* Outputs: plotly Figure or None.
* Side-effects: None.
* Error handling: Returns None if ticket_quality absent.
* Performance: value_counts over the column; OK.
* Limitations: No normalization/ordering; raw labels and counts.

G. [ChartGenerator.create_complexity_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Similar semantics for resolution_complexity with bar chart; returns None if column missing.

H. [ChartGenerator.create_department_volume()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Horizontal bar chart of top N Departments.
* Inputs: df, top_n (default 10).
* Behavior: value_counts().nlargest(top_n).
* Edge cases: Returns None if Department column missing.

I. [ChartGenerator.create_reassignment_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Bar chart of reassignment count distribution.
* Inputs: df; uses column 'Reassignment group count tracking_index'.
* Behavior: value_counts().sort_index().
* Edge cases: Returns None if column missing; relies on exact column naming.

J. [ChartGenerator.create_product_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Horizontal bar chart for extract_product distribution.
* Edge cases: Returns None if column missing.

K. [OnboardingAnalyzer. **init** ()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Configure AzureOpenAI client with endpoint, key, version, and deployment name.
* Inputs: azure_endpoint, api_key, deployment_name.
* Outputs: Client instance bound to self.
* Side-effects: None (network calls occur later).
* Error handling: None explicit here.

L. [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Build textual ticket context and collect summary metrics for LLM prompting.
* Inputs: df, max_tickets=50, dataset_name="Dataset".
* Outputs: Tuple[str, Dict] → (context_text, metrics dict).
* Behavior:
  * Defines relevant_cols and filters to available columns [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Random sampling of up to max_tickets with fixed random_state=42; if df empty, no sampling [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Aggregates high-level metrics (department_count, assignment_group_count, quality distribution, complexity distribution, reassignment distribution, top departments) only if columns present [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Appends “Sample Tickets” section iterating over sample rows, including available columns [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Side-effects: None.
* Error handling: None explicit; assumes columns exist before access.
* Performance:
  * value_counts and nunique are O(n); sampling O(n) depending on pandas implementation; iterrows over sample size up to max_tickets; prompt size grows linearly with sample ticket count and selected columns.
* Limitations:
  * Random sampling may not represent distribution; token budget risk if verbose fields (Description) are long; no PII redaction.
* Invariants:
  * metrics keys only included when columns present; context always includes "Dataset", "Total Tickets", and "Sample Tickets".
* Edge cases:
  * df with zero rows → "Total Tickets: 0", empty sample section; metrics likely partial or absent.

M. [OnboardingAnalyzer.analyze_onboarding_opportunities()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Compose system and user prompts and call Azure OpenAI chat completion API.
* Inputs: ticket_context (str), user_question (str), comparison_mode (bool=False).
* Outputs: Analysis string content; explicit error string on exception.
* Behavior:
  * Static system prompt includes ONBOARDING_GUIDELINES and structured instructions; appends comparison note if comparison_mode True [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * User prompt includes Question, Ticket Context, Expected Output Structure; adds “Comparison Insights” when applicable [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Calls client.chat.completions.create with max_completion_tokens=16000 [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Returns first choice message content if available; otherwise “API returned empty choices array” [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Catches all Exceptions and returns a multi-line error detail string [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Side-effects: External API call to Azure OpenAI.
* Performance: Dependent on LLM latency; large prompts can induce timeouts or high cost.
* Security:
  * Secrets provided via UI; risk of logging or exposure is low in code (no logging) but needs governance in target system.
  * Prompt injection risk unmitigated.
* Invariants:
  * Always returns a string (content or error message), never raises exceptions to caller.
* Edge cases:
  * Empty or excessively long ticket_context; no truncation or token budgeting beyond completion tokens.

N. [OnboardingAnalyzer.batch_analyze()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Sequentially run analyze_onboarding_opportunities across a list of questions; optional progress callback.
* Inputs: ticket_context, questions (list), progress_callback (callable or None).
* Outputs: list of (question, analysis) tuples (note: code returns list of tuples; report expects list of tuples).
* Side-effects: Calls external API repeatedly; cost/latency grows with number of questions.
* Error handling: None explicit here; relies on inner method’s error-string returns.
* Performance: Linear in number of questions; no concurrency or rate limiting.

O. [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Streamlit UI composition, session state, upload pipeline, dataset listing, comparison stats, Azure config inputs; orchestrates tabs for Analysis, Visualizations, History, Reports.
* Observed behaviors (from visible segments):
  * Sets page config and title [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Initializes session state with DatasetManager and batch_questions [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Sidebar collects Azure endpoint, API key, deployment name [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Sidebar: max_tickets slider, analysis mode radio, onboarding framework expander [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Tabs defined: Data Upload, Analysis, Visualizations, Historical Tracking, Reports [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Data Upload tab:
    * Accepts multiple .xlsx files; computes MD5 [calculate_file_hash()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView) and reads Excel; stores dataset via DatasetManager; shows metrics; displays comparison stats if >1 datasets [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Analysis tab begins [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), but full logic not visible in excerpt (To Confirm details: invocation of OnboardingAnalyzer, save_analysis(), filtering UI).
  * Reports tab: at runtime, uses [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView) when invoked (visible in tab code around [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)).
* Side-effects: File I/O (upload, read), in-memory storage, potential DB writes (not shown in visible lines).
* Security: Secrets entered via Streamlit inputs; To Confirm secret handling and non-persistence in logs.
* Limitations: UI and Engine tightly coupled; business logic embedded in Streamlit app.

P. [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)

* Responsibility: Create Markdown report including dataset summary and inserted analyses.
* Inputs: dataset_name, df, analyses (list of (question, analysis) tuples), charts (list of Figures/None).
* Outputs: Markdown string.
* Side-effects: None.
* Behavior:
  * Adds dataset metadata (counts) if columns present.
  * Iterates analyses and appends sections per question.
  * Appends chart count, not chart images.
* Limitations: No linkage to persisted analysis IDs; charts embedded count only; no references to source datasets.

4. Data Contracts & Schemas (as inferred)

* DataFrame schema (inferred incoming tickets)
  * Expected/used columns (as available): Department, Assignment Group, extract_product, summarize_ticket, ticket_quality, information_completeness, resolution_complexity, historical_similarity, Reassignment group count tracking_index [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), charts methods [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Ambiguities:
    * Column naming standardization (e.g., “Reassignment group count tracking_index” exact string dependency) — To Confirm mapping/normalization policy in Engine [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
    * Summaries vs raw descriptions (summarize_ticket vs Description) — To Confirm canonical field naming.
* SQLite tables (current monolith)
  * analyses: id, timestamp (TEXT), dataset_name (TEXT), dataset_hash (TEXT), department_filter (TEXT), question (TEXT), analysis_result (TEXT), ticket_count (INTEGER), metrics (TEXT JSON) [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * datasets: id, upload_timestamp, filename, file_hash UNIQUE, row_count, department_count, metadata (TEXT JSON) [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Observations:
    * datasets table is not actively written in visible app code; To Confirm if any code path persists datasets (plan notes it’s not used) [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
    * analyses lacks prompt_version; target will add [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Prompt metadata (current vs target)
  * Current: No explicit prompt_version; system and user prompts built ad-hoc in code [OnboardingAnalyzer.analyze_onboarding_opportunities()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Target: Versioned templates, persisted prompts, link analyses to prompt_version [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Report artifact
  * Markdown with static sections and counts [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Target: API-based report generation referencing persisted analyses and charts [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).

5. Cross-Cutting Concerns

* Logging
  * Current: No structured logging; print statements removed per comment [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Target: Structured logging (JSON), metrics, tracing [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Configuration/Secrets
  * Current: Azure endpoint/key/deployment collected in UI [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView); no central config management.
  * Target: config/settings.py; environment-based secrets; governance and RBAC [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Persistence
  * Current: SQLite file with analyses persisted; datasets table unused; no dataset/ticket persistence [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView); [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Target: Repositories for datasets/tickets/analyses/embeddings/clusters/prompts; SQLite dev, Postgres prod [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* UI coupling
  * Current: Streamlit UI hosts business logic, data ingestion, and analysis orchestration [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Target: UI consumes API; business logic in Engine/AI layers behind FastAPI [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Security/PII
  * Current: No explicit PII handling; prompts include raw ticket fields.
  * Target: PII anonymization in preprocess; RBAC; retention; prompt injection defenses [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).

6. Mapping to the New Modular Architecture

* Filter and sampling
  * From [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView) and monolith sampling in [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To: engine/features/sampling.py and ui/components/filters/ with stratified sampling [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Adapter boundary: UI passes filter/sampling params to API; Engine returns sampled IDs/segments and summaries.
* Dataset management
  * From [DatasetManager](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To: engine/ingest/loader.py + db/repositories/datasets_repo.py; persist datasets and tickets [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Boundaries: Loader validates, computes hashes; Repository persists; UI shows summaries via API.
* Charts/analytics
  * From [ChartGenerator.*](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To: engine/analytics/visualizations.py + ui/components/charts/ [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Boundaries: API provides metrics; UI renders charts; cache analytics [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* AI analysis & prompts
  * From [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [OnboardingAnalyzer.analyze_onboarding_opportunities()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [OnboardingAnalyzer.batch_analyze()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To: ai/llm/analysis.py + ai/llm/prompts/templates/ with versioning; sampling via Engine; retrieval/rerank optional [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Boundaries: API /analysis/run receives dataset_id(s), question, options; returns structured markdown and persists with prompt_version [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Persistence repositories
  * From [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [get_analysis_history()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To: db/sqlite/models.py + repositories; UI wired to /history/analyses [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Reports
  * From [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To: api/routers/reports.py + engine/analytics/metrics.py [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Boundaries: Report endpoints assemble markdown from persisted analyses and metric references.
* Vector store and retrieval
  * New: vector_store/ *, ai/embeddings/* , ai/llm/rerank.py [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Boundaries: API orchestrates embedding, indexing, search; Engine performs batch ops and backpressure [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).

7. Invariants & Testable Behaviors

* Filtering
  * No-op when Department column missing or departments not provided [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Correct inclusion semantics (all rows in output have Department within departments).
* Chart data fidelity and fallbacks
  * Each ChartGenerator.* returns None if required column absent [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Counts/distributions calculated via value_counts with expected column mapping.
* Analysis persistence
  * save_analysis stores metrics as JSON-serialized TEXT; timestamp is ISO 8601; ticket_count persists as integer [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * get_analysis_history returns DataFrame ordered DESC by timestamp with limit applied [get_analysis_history()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Context building
  * prepare_ticket_context includes dataset name, total tickets, optional department and assignment group counts, distributions if columns present, followed by a bounded sample with available columns [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Sampling uses fixed random_state=42; sample size ≤ max_tickets and ≤ df length [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* LLM orchestration
  * analyze_onboarding_opportunities always returns a string; adds comparison instructions in comparison_mode; uses max_completion_tokens=16000 [OnboardingAnalyzer.analyze_onboarding_opportunities()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * batch_analyze returns list of (question, analysis) tuples in order [OnboardingAnalyzer.batch_analyze()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Report generation
  * generate_report composes markdown with dataset summary (counts when columns present), sequential Q sections, and a final chart count [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Performance/security boundaries (to assert in new system)
  * Token budget: prompt size + completion budget must remain < model limits; target requires prompt size < 16k tokens [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView); enforce truncation/segmentation.
  * DB durability: writes are atomic; errors are handled with retries or surface gracefully.
  * PII handling: ensure redaction before prompt construction [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * Repository access avoids N+1; large aggregations are precomputed/cached [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).

8. Risks, Gaps, and Confirmations Needed

* Column normalization and mapping
  * Risk: Hard-coded column names (e.g., "Reassignment group count tracking_index") break across datasets.
  * To Confirm: Canonical schema map in engine/ingest/schema.py and normalization rules [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Dataset persistence usage
  * Gap: datasets table exists but not written by monolith UI.
  * To Confirm: Migration/backfill strategy on first run to persist historical in-memory datasets [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* save_analysis invocation sites
  * Gap: Visible code segments do not show where save_analysis is called from UI.
  * To Confirm: Actual call sites and parameters passed in Analysis/Reports tabs (lines not included in excerpt).
* Sampling strategy
  * Risk: Current random sampling biases outputs; token overflow risk.
  * Confirmations: Stratified sampling dimensions and bucket caps; summarization format and length constraints [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Prompt governance
  * Gap: No prompt_version stored in monolith.
  * To Confirm: Prompt template store design, versioning scheme, and linkage to analyses [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Security & compliance
  * Risk: Secrets input via UI; lack of audit logs/RBAC; PII exposure in prompts.
  * Confirmations: Secret storage approach, PII anonymization pipeline, audit log scope [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Retrieval/rerank/clustering
  * Gap: Absent in monolith; must define default models/parameters and resource sizing [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* Performance and scale
  * Risk: In-memory dataset handling; large Excel uploads; chart computations on full datasets.
  * Confirmations: API pagination for analytics, caching strategy, vector index persistence [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
* SQL safety for history endpoint
  * Risk: f-string LIMIT in [get_analysis_history()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView).
  * To Confirm: Enforce integer validation at API layer; parameterize queries in repositories.

9. References

* Monolith constructs
  * [filter_by_departments()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [init_database()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [save_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [get_analysis_history()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [DatasetManager. **init** ()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [DatasetManager.add_dataset()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [ChartGenerator.create_quality_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [ChartGenerator.create_complexity_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [ChartGenerator.create_department_volume()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [ChartGenerator.create_reassignment_analysis()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [ChartGenerator.create_product_distribution()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [OnboardingAnalyzer. **init** ()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [OnboardingAnalyzer.prepare_ticket_context()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [OnboardingAnalyzer.analyze_onboarding_opportunities()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [OnboardingAnalyzer.batch_analyze()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [main()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [generate_report()](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/servicenow_analyzer.py)
* Plan and target architecture
  * Overview and goals [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Current monolith summary [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Target architecture and repository layout [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Core data schema [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * API specifications [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Processing pipelines [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Modular prompt management [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Sampling and context budget enhancements [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Prototype architecture diagram [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Milestones and acceptance [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Operational considerations [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Near-term refactors/mapping [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Technology choices [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * Definition of Done [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * References to current code [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView)
  * [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/plan.md)

Appendix: Additional Observations

* Module import side-effect: Database initialization runs at import time [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView); in target system, move to startup hooks/migrations.
* Quality score helper: DatasetManager.get_comparison_stats references a private quality scoring helper (self._quality_score) [servicenow_analyzer.py](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView); ensure equivalent metric function exists in Engine analytics.

End of Reference Behavior Review. This document enumerates preserved semantics, improvements aligned with [plan.md](vscode-webview://1f4og3rp6on36a5d9dqql5ih0dqnhre7io5rv09oiimtt0dfoaue/index.html?id=feec2ead-4b10-4825-9e71-3909f8f1bd69&parentId=1&origin=a249b54d-28d7-4222-b3a6-8919b9c8ec7d&swVersion=4&extensionId=RooVeterinaryInc.roo-cline&platform=electron&vscode-resource-base-authority=vscode-resource.vscode-cdn.net&parentOrigin=vscode-file%3A%2F%2Fvscode-app&purpose=webviewView), defines data contracts and invariants, and lists confirmations needed to finalize module boundaries and tests for the next Architecture & Design Spec.
